### Код формы для лайка

```html
<form method="POST" action="{% url 'news:toggle_like' article.id %}">
  {% csrf_token %}
  <button type="submit" class="btn btn-primary">
    {% if request.META.REMOTE_ADDR in article.likes.values_list('ip_address', flat=True) %}
      Убрать лайк
    {% else %}
      Лайк
    {% endif %}
  </button>
</form>
```

### Разбор кода

1. **Форма (`<form>`):**
    - `method="POST"`: Указывает, что данные формы будут отправлены методом POST.
    - `action="{% url 'news:toggle_like' article.id %}"`: Указывает URL, на который будут отправлены данные формы. В данном случае, это URL для представления `toggle_like`, которое обрабатывает добавление или удаление лайка для статьи с идентификатором `article.id`.

2. **CSRF токен (`{% csrf_token %}`):**
    - `{% csrf_token %}`: Включает CSRF токен для защиты от межсайтовой подделки запросов (CSRF). Это важно для безопасности при отправке POST-запросов.

3. **Кнопка отправки (`<button>`):**
    - `type="submit"`: Указывает, что это кнопка отправки формы.
    - `class="btn btn-primary"`: Добавляет стили Bootstrap для кнопки.

4. **Условие для отображения текста кнопки (`{% if %}`):**
    - `{% if request.META.REMOTE_ADDR in article.likes.values_list('ip_address', flat=True) %}`: Проверяет, находится ли IP-адрес пользователя в списке IP-адресов, которые уже поставили лайк этой статье.
        - `request.META.REMOTE_ADDR`: Получает IP-адрес текущего пользователя.
        - `article.likes.values_list('ip_address', flat=True)`: Получает список всех IP-адресов, которые поставили лайк этой статье.
    - `Убрать лайк`: Если IP-адрес пользователя уже есть в списке лайков, отображается текст "Убрать лайк".
    - `Лайк`: Если IP-адрес пользователя не найден в списке лайков, отображается текст "Лайк".

### Как это работает

1. **Отправка формы:**
    - Когда пользователь нажимает на кнопку, форма отправляет POST-запрос на URL, указанный в `action`.
    - В данном случае, это URL для представления `toggle_like`, которое обрабатывает добавление или удаление лайка для статьи с идентификатором `article.id`.

2. **Обработка запроса:**
    - В представлении `toggle_like` проверяется, есть ли уже лайк от этого IP-адреса для данной статьи.
    - Если лайк уже есть, он удаляется.
    - Если лайка нет, он добавляется.

3. **Обновление страницы:**
    - После обработки запроса, пользователь перенаправляется обратно на страницу статьи, где форма снова отображается с обновленным текстом кнопки в зависимости от текущего состояния лайка.
